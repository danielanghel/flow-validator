{"version":3,"sources":["../../src/sync/Vmapping.js"],"names":["Vmapping","keys","values","m","VMappingType","o","objectType","validate","v","ks","errors","key","value","ke","ve","e","ValidationError","length","expected","got"],"mappings":";;;;;;;;;;;;;;;;;;QAMgBA,Q,GAAAA,Q;;AAJhB;;AACA;;AACA;;;;AAEO,SAASA,QAAT,CACLC,IADK,EAELC,MAFK,EAGe;AACpB,MAAMC,IAAI,IAAIC,mBAAJ,CAAiBH,IAAjB,EAAuBC,MAAvB,EAA+B,aAAK;AAC5C,QAAMG,IAAIC,iBAAWC,QAAX,CAAoBC,CAApB,CAAV;AACA,QAAMC,KAAK,oBAAYJ,CAAZ,CAAX;AACA,QAAMK,SAAS,EAAf;AAH4C;AAAA;AAAA;;AAAA;AAI5C,sDAAkBD,EAAlB,4GAAsB;AAAA,YAAXE,IAAW;;AACpB,YAAMC,QAAQP,EAAEM,IAAF,CAAd;AACA,YAAIE,WAAJ;AACA,YAAIC,WAAJ;AACA,YAAI;AACFb,eAAKM,QAAL,CAAcI,IAAd;AACD,SAFD,CAEE,OAAOI,CAAP,EAAU;AACV,cAAIA,aAAaC,gCAAjB,EAAkCH,KAAKE,CAAL,CAAlC,KACK,MAAMA,CAAN;AACN;AACD,YAAI;AACFb,iBAAOK,QAAP,CAAgBK,KAAhB;AACD,SAFD,CAEE,OAAOG,CAAP,EAAU;AACV,cAAIA,aAAaC,gCAAjB,EAAkCF,KAAKC,CAAL,CAAlC,KACK,MAAMA,CAAN;AACN;AACD,YAAIF,MAAMC,EAAV,EAAc;AACZJ,iBAAOC,IAAP,IAAc,EAAEA,KAAKE,EAAP,EAAWD,OAAOE,EAAlB,EAAd;AACD;AACF;AAvB2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAwB5C,QAAI,mCAA2BJ,MAA3B,EAAmCO,MAAvC,EACE,MAAM,IAAID,gCAAJ,CAAoB,EAAEE,UAAUf,CAAZ,EAAegB,KAAKX,CAApB,EAAuBE,cAAvB,EAApB,CAAN;AACF,WAASF,CAAT,CA1B4C,CA0BR;AACrC,GA3BS,CAAV;AA4BA,SAAOL,CAAP;AACD","file":"Vmapping.js","sourcesContent":["// @flow\n\nimport { ValidationError } from \"./ValidationError\";\nimport { VType, VMappingType } from \"./VType\";\nimport { objectType } from \"./base\";\n\nexport function Vmapping<K: string, V>(\n  keys: VType<K>,\n  values: VType<V>\n): VMappingType<K, V> {\n  const m = new VMappingType(keys, values, v => {\n    const o = objectType.validate(v);\n    const ks = Object.keys(o);\n    const errors = {};\n    for (const key of ks) {\n      const value = o[key];\n      let ke;\n      let ve;\n      try {\n        keys.validate(key);\n      } catch (e) {\n        if (e instanceof ValidationError) ke = e;\n        else throw e;\n      }\n      try {\n        values.validate(value);\n      } catch (e) {\n        if (e instanceof ValidationError) ve = e;\n        else throw e;\n      }\n      if (ke || ve) {\n        errors[key] = { key: ke, value: ve };\n      }\n    }\n    if (Object.getOwnPropertyNames(errors).length)\n      throw new ValidationError({ expected: m, got: v, errors });\n    return ((v: any): { [key: K]: V }); // eslint-disable-line flowtype/no-weak-types\n  });\n  return m;\n}\n"]}