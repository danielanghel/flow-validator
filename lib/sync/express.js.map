{"version":3,"sources":["../../src/sync/express.js"],"names":["middleware","validator","fun","req","res","next","data","parse","e","requestMapping","endpoint","express"],"mappings":";;;;;;;AAEA;;AAGA,SAASA,UAAT,CACEC,SADF,EAEEC,GAFF,EAGc;AACZ,SAAO,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACzB,QAAI;AACF,UAAMC,OAAOL,UAAUM,KAAV,CAAgBJ,GAAhB,CAAb;AACAD,UAAII,IAAJ,EAAUF,GAAV,EAAeC,IAAf;AACD,KAHD,CAGE,OAAOG,CAAP,EAAU;AACVH,WAAKG,CAAL;AACD;AACF,GAPD;AAQD;;AAED,SAASC,cAAT,CACER,SADF,EAEEC,GAFF,EAGc;AACZ,SAAO,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACzB,QAAI;AACF,UAAMC,OAAOL,UAAUM,KAAV,CAAgBJ,GAAhB,CAAb;AACAD,UAAII,IAAJ,EAAUF,GAAV;AACD,KAHD,CAGE,OAAOI,CAAP,EAAU;AACVH;AACD;AACF,GAPD;AAQD;;AAED,SAASK,QAAT,CACET,SADF,EAEEC,GAFF,EAGc;AACZ,SAAO,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACzB,QAAI;AACF,UAAMC,OAAOL,UAAUM,KAAV,CAAgBJ,GAAhB,CAAb;AACAD,UAAII,IAAJ,EAAUF,GAAV;AACD,KAHD,CAGE,OAAOI,CAAP,EAAU;AACVH,WAAKG,CAAL;AACD;AACF,GAPD;AAQD;;AAEM,IAAMG,4BAAU,EAAED,kBAAF,EAAYV,sBAAZ,EAAwBS,8BAAxB,EAAhB","file":"express.js","sourcesContent":["// @flow\n\nimport { Type } from \"./Type\";\nimport type { Middleware, $Response, NextFunction } from \"express\";\n\nfunction middleware<T>(\n  validator: Type<T>,\n  fun: (req: T, res: $Response, next: NextFunction) => mixed\n): Middleware {\n  return (req, res, next) => {\n    try {\n      const data = validator.parse(req);\n      fun(data, res, next);\n    } catch (e) {\n      next(e);\n    }\n  };\n}\n\nfunction requestMapping<T>(\n  validator: Type<T>,\n  fun: (req: T, res: $Response) => mixed\n): Middleware {\n  return (req, res, next) => {\n    try {\n      const data = validator.parse(req);\n      fun(data, res);\n    } catch (e) {\n      next();\n    }\n  };\n}\n\nfunction endpoint<T>(\n  validator: Type<T>,\n  fun: (req: T, res: $Response) => mixed\n): Middleware {\n  return (req, res, next) => {\n    try {\n      const data = validator.parse(req);\n      fun(data, res);\n    } catch (e) {\n      next(e);\n    }\n  };\n}\n\nexport const express = { endpoint, middleware, requestMapping };\n"]}